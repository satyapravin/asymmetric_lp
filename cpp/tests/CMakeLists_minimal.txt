# Simplified Test CMakeLists.txt
cmake_minimum_required(VERSION 3.16)

# Find required packages
find_package(simdjson REQUIRED)

# Create a minimal test executable that doesn't depend on the full system
add_executable(run_tests
  test_runner_standalone.cpp
  # Test Configuration Manager (standalone)
  config/test_config_manager_standalone.cpp
  # Protocol Buffer Tests (standalone)
  unit/protobuf/test_protocol_buffers_standalone.cpp
)

# Link with minimal required libraries
target_link_libraries(run_tests PRIVATE 
  simdjson::simdjson
)

# Include directories
target_include_directories(run_tests PRIVATE 
  ${CMAKE_CURRENT_SOURCE_DIR}
  ${CMAKE_CURRENT_SOURCE_DIR}/..
  ${CMAKE_CURRENT_SOURCE_DIR}/config
)

# Add test to CTest
enable_testing()
add_test(NAME unit_tests COMMAND run_tests)

# Set test properties
set_tests_properties(unit_tests PROPERTIES
  TIMEOUT 30
  WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}
)
